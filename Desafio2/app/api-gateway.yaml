apiVersion: v1
data:
  .dockerconfigjson: eyJhdXRocyI6eyI5NzQ5Nzk2MDIyMTEuZGtyLmVjci51cy1lYXN0LTEuYW1hem9uYXdzLmNvbSI6eyJ1c2VybmFtZSI6IkFXUyIsInBhc3N3b3JkIjoiZXlKd1lYbHNiMkZrSWpvaU0weHpVVGRwUkV0RVkyaG9LM1ppYzNwRVNVSlNTSFYwWlUxdllWWlhVWGxVVW04MVVVUXZPWFV2Y3l0S1dXRk1LMFZFTW1wblIxSjBTazFwUzJaamVUUnZabWd4VnpGMFJsbDRjVGhNYldabFN6ZEhOekpYU0RWdVRYaFpUamt2UWxoSGFVTnhVSEZ5ZEUxa2MwbHlOakl4Tmt4UFFYazBiR0pTVkcxd1JVNVBLM0ZJTmxwWFVtMDBUaXRHWm0xWk5uWlJSM2tyYzFrNVJHNTFTVkUwZGxSbU1EbFlZM3BLWXpKTFkxQXJRakZFU25wVlpXWjBhRnBpWmt4d1ZFMU9jVUY2U1dwdE9WZ3hjakZEV2xGT1MzcDNRbEJaVjFkTFkwMXhUV1JHVFVaVWJHaFFXVWt6YWpoMmFXRnVUblZDWXpCVGRrSmpNMWxWVkRobWFYRkVWM0Y2TjJ3MU4weFlUVmhUV0hOUWMzcG1aRWd2ZGxOUU4xWXJMM0ZWTW0wMGRXRllNa1ZQUlc5WE1YaE9WMEZRZFZVd1RETm5kMFZ6VG1wNk0xQTJNbTVNZUdSbVFVZEpWR3B2YzJaSVpEZGxkRWwxZUN0UE9FVk5Sa2xPYzNKMGQwZE9WVVZSZFRJd2MzUkpjamMwZGxsd1pFMTNkVmhWUmtaeGVrRXhLM0JyYUU0MU5HazFNSGhMVDJKUVJVRjNTbWRIV2l0aGVtODRkMk5wU25kVlpGUnpUMVJIVTJ4WlRHZ3dVMVpsYkRsbmFUY3llVWRGUW5CMVpVUkdSVmQxTjFoMGFFZEdOMnh2TnpkT09HVkRNa0l4VVRjemJtZFZZbkJTTUZWcEsxaEhaWFpWY1hCQlZUQlpNMGhHYUZWTlpHNVBiR3BPVjBWeFVsZEplRWMyZGxGQ2NWZHlPVkJVU0hCYVNITnVaVkZhY1U1NlJ6ZHBWM2hOVDJaUmNWaE5UbU5RWnpsSk5XWnZTMHMzTmt4bE9USkJaRE5STUhZM1pIbDZZa3ByY1hRMVpHdEhRelJwUjJ0YVIzbFNVMHhrTVRGQ05UQmxUVWsyWVc1aVRUWTBhVEIxVUVoR2VXNXNhWGcwYlM5WFdYaFVWVTVKUkN0UWJITjJXRFEzTkRKRVZrbGtPVXhoSzFRemFEaHljV0Z3YnpKdmRWcFFOWEo0Tlc1dVZtUmxlVk5PY1dSNGEzVTBVekZNUTFKck5ubzFiRXN4YW10TmNtSk5kVnB0YlRobU9IRTNRM0pvZUZaa2NVdENLMDE0TkhwWVZVUXhNUzgwTkZGbk9ETmxSREJpVGsxMU0wRktiSFIzUVZSV1MwdFhWa3hqY1RVMmRWQldabmxoWkZaMEt5OXVhVmhwVlhCdUsyTTFWVzV3VEZWSVdHVnBlbkk0UWxOdWNVOHllbTE2TVdkelJEVmxiVmw0Ym14TWNtMHZiR1F4TmxwcE5VTnZNamg0T1hVNE9VWllkVWQwUkZSaGNURjViRWw0YWpoWEwzRlBhWGh2VUd4VFRHOVBTMFY1V2xwUVlXUjFjVlJWVUZoU2EwRkNNV0ZvY2pkaEwwMTJkbm8wZDFwemIyVm9NRGxNZFdsUFYyUk9kMVY0YW5abE5URmxPRXhvVEdWMlFYVktRMVpzUjBzNVJHMXRNM0pJVjFadU1taExkRFJzUlhSRWFsRk9kVEJzU0VseVVreE1VSFZGUkcxSmRuWlplbGxtWmtGTE1qZEdTbkZzSzNsQlNucE5hamhuYTA1TmRHNHdUV2hMWTJ4a1RWTllVbTVCZGxaRFJGUnNiazVOVkZSVU1tVTNOemxMTkcxRFUxRjROVTlsUjJaTFVFWjVSVmxoUVQwOUlpd2laR0YwWVd0bGVTSTZJa0ZSUlVKQlNHaDNiVEJaWVVsVFNtVlNkRXB0Tlc0eFJ6WjFjV1ZsYTFoMWIxaFlVR1UxVlVaalpUbFNjVGd2TVRSM1FVRkJTRFIzWmtGWlNrdHZXa2xvZG1OT1FWRmpSMjlIT0hkaVVVbENRVVJDYjBKbmEzRm9hMmxIT1hjd1FrSjNSWGRJWjFsS1dVbGFTVUZYVlVSQ1FVVjFUVUpGUlVSR1VUZGpNVTFYYm5KSVNqSkVkMlJMZDBsQ1JVbEJOek50WlZwVE1uVXpNRTVWTTA1WVZ6WlpRMU5zTmtkQlFrMHdaMGRSU0dwTFJTc3ZaRUp0ZFdaRWNYVkpia2RzV1d0VmFsQndSMXBFV1hoeU9ERktZV0Z6TDJ0dVZVTTFOVUZyUmpZclZGazlJaXdpZG1WeWMybHZiaUk2SWpJaUxDSjBlWEJsSWpvaVJFRlVRVjlMUlZraUxDSmxlSEJwY21GMGFXOXVJam94TmpVM09EVTVNVGMxZlE9PSIsImF1dGgiOiJRVmRUT21WNVNuZFpXR3h6WWpKR2EwbHFiMmxOTUhoNlZWUmtjRkpGZEVWWk1taHZTek5hYVdNemNFVlRWVXBUVTBoV01GcFZNWFpaVmxwWVZWaHNWVlZ0T0RGVlZWRjJUMWhWZG1ONWRFdFhWMFpOU3pCV1JVMXRjRzVTTVVvd1Uyc3hjRk15V21wbFZGSjJXbTFuZUZaNlJqQlNiR3cwWTFSb1RXSlhXbXhUZW1SSVRucEtXRk5FVm5WVVdHaGFWR3ByZGxGc2FFaGhWVTU0VlVoR2VXUkZNV3RqTUd4NVRtcEplRTVyZUZCUldHc3dZa2RLVTFaSE1YZFNWVFZRU3pOR1NVNXNjRmhWYlRBd1ZHbDBSMXB0TVZwT2JscFNVak5yY21NeGF6VlNSelV4VTFaRk1HUnNVbTFOUkd4WldUTndTMWw2U2t4Wk1VRnlVV3BHUlZOdWNGWmFWMW93WVVad2FWcHJlSGRXUlRGUFkxVkdObE5YY0hSUFZtZDRZMnBHUkZkc1JrOVRNM0F6VVd4Q1dsWXhaRXhaTURGNFZGZFNSMVJWV2xWaVIyaFJWMVZyZW1GcWFESmhWMFoxVkc1V1ExbDZRbFJrYTBwcVRURnNWbFpFYUcxaFdFWkZWak5HTms0eWR6Rk9NSGhaVkZab1ZGZElUbEZqTTNCdFdrVm5kbVJzVGxGT01WbHlURE5HVmsxdE1EQmtWMFpaVFd0V1VGSlhPVmhOV0doUFZqQkdVV1JXVlhkVVJFNXVaREJXZWxSdGNEWk5NVUV5VFcwMVRXVkhVbTFSVldSS1ZrZHdkbU15V2tsYVJHUnNaRVZzTVdWRGRGQlBSVlpPVW10c1QyTXpTakJrTUdSUFZsVldVbVJVU1hkak0xSktZMnBqTUdSc2JIZGFSVEV6WkZab1ZsSnJXbmhsYTBWNFN6TkNjbUZGTkRGT1Iyc3hUVWhvVEZReVNsRlNWVVl6VTIxa1NGZHBkR2hsYlRnMFpESk9jRk51WkZaYVJsSjZWREZTU0ZVeWVGcFVSMmQzVlRGYWJHSkViRzVoVkdONVpWVmtSbEZ1UWpGYVZWSkhVbFprTVU0eGFEQmhSV1JIVGpKNGRrNTZaRTlQUjFaRVRXdEplRlZVWTNwaWJXUldXVzVDVTAxR1ZuQkxNV2hJV2xoYVZtTllRa0pXVkVKYVRUQm9SMkZHVms1YVJ6VlFZa2R3VDFZd1ZuaFZiR1JLWlVWak1tUnNSa05qVm1SNVQxWkNWVk5JUW1GVFNFNTFXbFpHWVdOVk5UWlNlbVJ3VmpOb1RsUXlXbEpqVm1oT1ZHMU9VVnA2YkVwT1YxcDJVekJ6TTA1cmVHeFBWRXBDV2tST1VrMUlXVE5hU0d3MldXdHdjbU5ZVVRGYVIzUklVWHBTY0ZJeWRHRlNNMnhUVlRCNGEwMVVSa05PVkVKc1ZGVnJNbGxYTldsVVZGa3dZVlJDTVZWRmFFZGxWelZ6WVZobk1HSlRPVmhYV0doVlZsVTFTbEpEZEZGaVNFNHlWMFJSTTA1RVNrVldhMnhyVDFWNGFFc3hVWHBoUkdoNVkxZEdkMko2U25aa1ZuQlJUbGhLTkU1WE5YVldiVkpzWlZaT1QyTlhValJoTTFVd1ZYcEdUVkV4U25KT2JtOHhZa1Z6ZUdGdGRFNWpiVXBPWkZad2RHSlVhRzFQU0VVelVUTktiMlZHV210alZYUkRTekF4TkU1SWNGbFdWVkY0VFZNNE1FNUdSbTVQUkU1c1VrUkNhVlJyTVRGTk1FWkxZa2hTTTFGV1VsZFRNSFJZVm10NGFtTlVWVEprVmtKWFdtNXNhRnBHV2pCTGVUbDFZVlpvY0ZaWVFuVkxNazB4VmxjMWQxUkdWa2xYUjFad1pXNUpORkZzVG5WalZUaDVaVzB4TmsxWFpIcFNSRlpzWWxac05HSnRlRTFqYlRCMllrZFJlRTVzY0hCT1ZVNTJUV3BvTkU5WVZUUlBWVnBaWkZWa01GSkdVbWhqVkVZMVlrVnNOR0ZxYUZoTU0wWlFZVmhvZGxWSGVGUlVSemxRVXpCV05WZHNjRkZaVjFJeFkxWlNWbFZHYUZOaE1FWkRUVmRHYjJOcVpHaE1NREV5Wkc1dk1HUXhjSHBpTWxadlRVUnNUV1JYYkZCV01sSlBaREZXTkdGdVdteE9WRVpzVDBWNGIxUkhWakpSV0ZaTFVURmFjMUl3Y3pWU1J6RjBUVE5LU1ZZeFduVk5iV2hNWkVSU2MxSllVa1ZoYkVaUFpGUkNjMU5GYkhsVmEzaE5WVWhXUmxKSE1VcGtibHBhWld4c2JWcHJSa3hOYW1SSFUyNUdjMHN6YkVKVGJuQk9ZV3BvYm1Fd05VNWtSelIzVkZkb1RGa3llR3RVVms1WlZXMDFRbVJzV2tSU1JsSnpZbXMxVGxaR1VsVk5iVlV6VG5wc1RFNUhNVVJWTVVZMFRsVTViRkl5V2t4VlJWbzFVbFpzYUZGVU1EbEphWGRwV2tkR01GbFhkR3hsVTBrMlNXdEdVbEpWU2tKVFIyZ3pZbFJDV2xsVmJGUlRiVlpUWkVWd2RFNVhOSGhTZWxveFkxZFdiR0V4YURGaU1XaFpWVWRWTVZaVldtcGFWR3hUWTFSbmRrMVVVak5SVlVaQ1UwUlNNMXByUmxwVGEzUjJWMnRzYjJSdFRrOVJWa1pxVWpJNVNFOUlaR2xWVld4RFVWVlNRMkl3U201aE0wWnZZVEpzU0U5WVkzZFJhMG96VWxoa1NWb3hiRXRYVld4aFUxVkdXRlpWVWtOUlZWWXhWRlZLUmxKVlVrZFZWR1JxVFZVeFdHSnVTa2xUYWtwRlpESlNUR1F3YkVOU1ZXeENUbnBPZEZwV2NGUk5ibFY2VFVVMVZrMHdOVmxXZWxwYVVURk9jMDVyWkVKUmF6QjNXakJrVWxOSGNFeFNVM04yV2tWS2RHUlhXa1ZqV0ZaS1ltdGtjMWRYZEZaaGJFSjNVakZ3UlZkWWFIbFBSRVpMV1ZkR2Vrd3lkSFZXVlUweFRsVkdjbEpxV1hKV1JtczVTV2wzYVdSdFZubGpNbXgyWW1sSk5rbHFTV2xNUTBvd1pWaENiRWxxYjJsU1JVWlZVVlk1VEZKV2EybE1RMHBzWlVoQ2NHTnRSakJoVnpsMVNXcHZlRTVxVlROUFJGVTFUVlJqTVdaUlBUMD0ifX19
kind: Secret
metadata:
  name: regcred
  namespace: apigw
type: kubernetes.io/dockerconfigjson
#https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/
---
apiVersion: v1
kind: Service
metadata:
  name: apigw-microapigw
  namespace: apigw
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 80
  selector:
    app: apigw
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: apigw-microapigw
  namespace: apigw
spec:
  replicas: 1
  selector:
    matchLabels:
      app: apigw
  template:
    metadata:
      labels:
        app: apigw
    spec:
      containers:
      - name: apigw
        image: 974979602211.dkr.ecr.us-east-1.amazonaws.com/nginx-api-gateway:gw-test-9.0
        imagePullPolicy: Always
        ports:
        - containerPort: 80
      imagePullSecrets:
        - name: regcred
